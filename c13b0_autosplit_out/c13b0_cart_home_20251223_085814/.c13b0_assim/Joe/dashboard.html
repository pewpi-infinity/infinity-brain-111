<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Infinity Launcher · All-in-One Portal</title>
  <meta name="color-scheme" content="light dark"/>
  <style>
    :root {
      --blue-1: #003087;
      --blue-2: #0b5fd7;
      --bg: #fff;
      --panel: #f8fafc;
      --muted: #637083;
      --radius: 12px;
      font-family: system-ui, "Segoe UI", Roboto, Arial, sans-serif;
    }
    html, body { margin:0; padding:0; background:var(--bg); color:#051426; min-height:100vh;}
    .app { max-width:480px; margin:0 auto; padding:0 0 60px 0; }
    header { display:flex;align-items:center;justify-content:space-between;padding:14px 10px;background:#fff;border-bottom:1.5px solid #e6e9ef; }
    .logoText { font-weight:700; color:var(--blue-1); font-size:20px; letter-spacing:1px; }
    .sub { font-size:13px; color:var(--muted);}
    .nav { display:flex; gap:17px; }
    .nav a { color:var(--blue-2); font-weight:600; text-decoration:none; font-size:17px; padding:7px 0;}
    .nav a.active, .nav a:hover { border-bottom:2.5px solid var(--blue-2);}
    .user-badge { display:flex; align-items:center; gap:8px; font-size:14px; color:var(--blue-1); }
    .user-badge button { background:none; border:1px solid #e6e9ef; border-radius:6px; padding:4px 8px; cursor:pointer; font-size:12px; }
    main { padding:20px 0 10px 0;}
    .card { background:var(--panel);border-radius:14px;padding:20px;margin-bottom:18px;box-shadow:0 2px 12px #00308716; }
    .card h2 { margin:0 0 8px 0; color:var(--blue-1);}
    .apps { display:flex; flex-direction:column; gap:18px; }
    .app-link { background:#fff; border-radius:10px; box-shadow:0 2px 12px #00308711; padding:16px; display:flex; flex-direction:column; align-items:flex-start;}
    .app-link a { color:var(--blue-2); font-weight:700; font-size:17px; text-decoration:none; }
    .desc { font-size:13px; color:var(--muted);margin-top:4px;}
    .live { color:#22c55e; font-weight:700; font-size:12px;}
    .panel { display:none; position:fixed; left:0; top:0; width:100vw; height:100vh; z-index:1000; background:rgba(2,6,23,0.33);}
    .panel .content { background:#fff; border-radius:14px; max-width:410px; margin:60px auto; padding:20px; box-shadow:0 12px 40px #00308726;}
    .panel .close { position:absolute; right:18px; top:22px; background:none; border:0; font-size:22px; color:var(--muted); cursor:pointer;}
    .rogersDock { position:fixed; right:16px; bottom:16px; z-index:999; }
    .rogBtn { width:56px; height:56px; border-radius:50%; background:linear-gradient(135deg, var(--blue-1), var(--blue-2)); display:flex;align-items:center;justify-content:center; color:#fff;font-weight:900; font-size:28px; box-shadow:0 10px 30px #0b5fd71a; cursor:pointer; border:none;}
    .rogBtn img { width:100%; height:100%; object-fit:cover; border-radius:50%; display:block; }
    .chatBox { position:fixed; right:10px; bottom:80px; width:95vw; max-width:340px; border-radius:12px; background:#fff; box-shadow:0 20px 50px #03183e29; display:none; flex-direction:column; z-index:999; overflow:hidden; border:1px solid #e6e9ef;}
    .chatBox.open { display:flex; }
    .chatHeader { padding:10px 14px; background:linear-gradient(90deg, var(--blue-1), var(--blue-2)); color:#fff; display:flex; justify-content:space-between;align-items:center; font-weight:bold;}
    .chatBody { padding:12px;height:210px;overflow-y:auto;background:var(--panel);font-size:15px;}
    .chatInput { display:flex; padding:10px; border-top:1px solid #e6e9ef; background:#f9fbfd;}
    .chatInput input { flex:1;padding:8px;border-radius:8px;border:1px solid #e6e9ef;font-size:16px;}
    .chatInput button { background:var(--blue-1); color:#fff; border:none; border-radius:8px; font-weight:700; padding:8px 14px; margin-left:7px; font-size:16px;}
    .bubble { margin:7px 0; max-width:90%; padding:9px 13px; border-radius:13px; word-break:break-word;}
    .me { background:rgba(11,95,215,0.08); border:1px solid rgba(11,95,215,0.11);margin-left:auto;}
    .ai { background:#fff; border:1px solid #e6e9ef;}
    .sidebarBtn { position:fixed;left:12px;top: 64px;width:48px;height:48px;border-radius:12px;background:#fff;border:1px solid #e6e9ef;display:flex;align-items:center;justify-content:center;font-size:26px;color:var(--blue-2);z-index:1001;cursor:pointer;}
    .sidebar { position:fixed;left:0;top:0;bottom:0;width:86vw;max-width:320px;background:#fff;box-shadow:20px 0 60px #03183e19;transform:translateX(-110%);transition:transform .28s;z-index:9999;padding:22px 12px 0 12px;overflow:auto;}
    .sidebar.open { transform:translateX(0);}
    .sidebar h3 { margin-top:0;}
    .sbLink { display:block;padding:10px 0;font-weight:700;color:var(--blue-1);text-decoration:none;border-bottom:1px solid #eee;}
    .devBox { background:#f8fafc;border-radius:10px;padding:12px;margin-top:14px;}
    @media (max-width:600px) {
      .app { max-width:100vw; }
      .chatBox { left:4px; right:4px;width:auto;}
      .panel .content {width:97vw;max-width:97vw;}
      .sidebar { width:98vw;max-width:98vw;}
    }
    .welcome-banner { background:linear-gradient(135deg, var(--blue-1), var(--blue-2)); color:#fff; padding:16px; border-radius:12px; margin-bottom:18px; }
    .welcome-banner h3 { margin:0 0 4px 0; }
    .welcome-banner p { margin:0; font-size:14px; opacity:0.9; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <span class="logoText">INFINITY</span>
      <div class="user-badge">
        <span id="userDisplay">User</span>
        <button onclick="logout()">Logout</button>
      </div>
    </header>
    
    <main id="mainPanel">
      <div class="welcome-banner">
        <h3>Welcome back, <span id="userName">User</span>!</h3>
        <p>Your secure session is active</p>
      </div>
      
      <div class="card">
        <h2>Infinity All-in-One Launcher</h2>
        <div class="sub" style="margin-bottom:13px;">All your tools, AI, and projects—one page, mobile ready.</div>
        <div class="apps">
          <div class="app-link">
            <a href="http://127.0.0.1:8080" target="_blank">Portal UI</a>
            <div class="desc">Day-to-day dashboard, navigation, tools</div>
            <span class="live">LIVE on :8080</span>
          </div>
          <div class="app-link">
            <a href="http://127.0.0.1:5050" target="_blank">Rogers AI Chat</a>
            <div class="desc">Conversational AI, dev chat, steering wheel</div>
            <span class="live">LIVE on :5050</span>
          </div>
          <div class="app-link">
            <a href="http://127.0.0.1:8000" target="_blank">Socializer (Demo)</a>
            <div class="desc">Community chat, channels, games (edit URL as needed)</div>
            <span class="live">:8000 (if running)</span>
          </div>
          <div class="app-link">
            <a href="pi_singer.html" target="_blank">Pi Singer</a>
            <div class="desc">Digit-to-music generator (your code, local HTML file)</div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h2>Quick Actions & Resources</h2>
        <ul style="margin-left:18px;">
          <li>Sidebar: Access all settings, dev tools, saved sessions</li>
          <li>Floating Rogers AI: Chat anytime <b>R</b></li>
          <li>Visit each app, then bookmark for fast access</li>
        </ul>
      </div>
      
      <div class="card">
        <h2>Session Information</h2>
        <div class="devBox">
          <div><b>User ID:</b> <span id="userId">—</span></div>
          <div><b>Email:</b> <span id="userEmail">—</span></div>
          <div><b>Login Time:</b> <span id="loginTime">—</span></div>
          <div><b>Session Expires:</b> <span id="expiresAt">—</span></div>
        </div>
      </div>
    </main>
    
    <!-- Sidebar -->
    <button class="sidebarBtn" onclick="toggleSidebar()">☰</button>
    <aside class="sidebar" id="sidebar">
      <h3>Infinity Menu</h3>
      <a class="sbLink" href="dashboard.html">Home</a>
      <a class="sbLink" href="http://127.0.0.1:8080" target="_blank">Portal UI</a>
      <a class="sbLink" href="http://127.0.0.1:5050" target="_blank">Rogers AI Chat</a>
      <a class="sbLink" href="http://127.0.0.1:8000" target="_blank">Socializer</a>
      <a class="sbLink" href="pi_singer.html" target="_blank">Pi Singer</a>
      <div style="margin-top:18px;">
        <button onclick="logout()" style="width:100%;padding:10px;background:linear-gradient(135deg, var(--blue-1), var(--blue-2));color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;">Logout</button>
      </div>
      <div style="margin-top:18px;font-size:13px;color:#6b7280;">Contact: infinitystockinvesting@gmail.com</div>
    </aside>

    <!-- Rogers AI Dock -->
    <div class="rogersDock">
      <button class="rogBtn" id="rogBtn" title="Rogers AI"><img src="einstein-avatar.png" alt="Rogers Einstein" onerror="this.style.display='none'; const btn=this.closest('button'); if(btn && !btn.textContent.trim()) btn.textContent='R';"></button>
    </div>
    <div class="chatBox" id="chatBox">
      <div class="chatHeader">
        <span>Rogers AI</span>
        <button onclick="toggleChat()" style="background:transparent;border:none;color:#fff;font-size:20px;cursor:pointer;">✕</button>
      </div>
      <div class="chatBody" id="chatBody"></div>
      <form class="chatInput" onsubmit="event.preventDefault();sendChat();">
        <input id="chatIn" autocomplete="off" placeholder="Ask Rogers anything...">
        <button type="submit">Send</button>
      </form>
    </div>
  </div>

<script>
// Check authentication on page load
window.addEventListener('DOMContentLoaded', () => {
  if (!window.InfinityAuth || !window.InfinityAuth.isAuthenticated()) {
    window.location.href = '/';
    return;
  }
  
  initializeDashboard();
});

function initializeDashboard() {
  const userInfo = window.InfinityAuth.getUserInfo();
  const session = window.InfinityAuth.getSession();
  
  if (userInfo) {
    document.getElementById('userName').textContent = userInfo.username;
    document.getElementById('userDisplay').textContent = userInfo.username;
    document.getElementById('userId').textContent = userInfo.userId;
    document.getElementById('userEmail').textContent = userInfo.email;
  }
  
  if (session) {
    const loginTime = new Date(session.loginTime);
    const expiresAt = new Date(session.expiresAt);
    
    document.getElementById('loginTime').textContent = loginTime.toLocaleString();
    document.getElementById('expiresAt').textContent = expiresAt.toLocaleString();
  }
}

function logout() {
  if (confirm('Are you sure you want to logout?')) {
    window.InfinityAuth.logout();
  }
}

function toggleSidebar() { 
  document.getElementById('sidebar').classList.toggle('open'); 
}

/* Rogers Chat Dock Logic */
const rogBtn = document.getElementById('rogBtn');
const chatBox = document.getElementById('chatBox');
rogBtn.onclick = () => { 
  chatBox.classList.add('open'); 
  setTimeout(() => document.getElementById('chatIn').focus(), 120); 
}

function toggleChat() { 
  chatBox.classList.remove('open'); 
}

const chatBody = document.getElementById('chatBody');
const chatIn = document.getElementById('chatIn');

function addBubble(role, text) {
  const div = document.createElement('div');
  div.className = 'bubble ' + (role === 'me' ? 'me' : 'ai');
  div.textContent = text;
  chatBody.appendChild(div);
  chatBody.scrollTop = chatBody.scrollHeight;
}

function sendChat() {
  const t = chatIn.value.trim();
  if (!t) return;
  addBubble('me', t);
  chatIn.value = '';
  setTimeout(() => {
    let reply = '';
    if (/help|how/i.test(t)) reply = "I'm Rogers, your Infinity assistant. How can I help?";
    else if (/energy|token/i.test(t)) reply = "Energy features are in development. Check your profile soon!";
    else if (/voice|audio/i.test(t)) reply = "Voice features are coming! Try the mic in your next update.";
    else if (/weather|news/i.test(t)) reply = "Live data will be in the next Infinity release.";
    else reply = "Got it! (This is a demo. For live AI, connect the backend API.)";
    addBubble('ai', reply);
  }, 400);
}

addBubble('ai', "Hi! Rogers AI is ready. Ask anything or say 'help'.");
</script>
</body>
</html>
